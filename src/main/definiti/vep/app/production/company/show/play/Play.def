package vep.app.production.company.show.play

import vep.app.common.verifications.RequiredString
import vep.app.common.verifications.IsNonBlank
import vep.app.common.verifications.NonEmptyList
import vep.app.common.verifications.IsPositive

type Play {
  id: RequiredString
  theater: String verifying IsNonBlank("Veuillez renseigner le théâtre")
  date: Date
  reservationEndDate: Date
  prices: NonEmptyList[PlayPrice]

  verify {
    "La date de fin de réservation doit être avant la date de la séance"
    (play) => {
      play.reservationEndDate.isBefore(play.date)
    }
  }
}

type PlayPrice {
  name: String verifying IsNonBlank("Veuillez renseigner le nom du prix")
  value: Number verifying IsPositive("Veuillez indiquer un prix strictement positif")
  condition: Option[String]
}

type PlayCreation {
  theater: String verifying IsNonBlank("Veuillez renseigner le théâtre")
  date: Date
  reservationEndDate: Date
  prices: NonEmptyList[PlayPrice]

  verify {
    "La date de fin de réservation doit être avant la date de la séance"
    (play) => {
      play.reservationEndDate.isBefore(play.date)
    }
  }
}