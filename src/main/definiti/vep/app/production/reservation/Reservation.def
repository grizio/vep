package vep.app.production.reservation

import vep.app.common.verifications.IsNonBlank
import vep.app.common.verifications.ListIsNonEmpty
import vep.app.common.verifications.ListHasUniqueElements
import vep.app.common.verifications.Email

type ReservationCreation {
  firstName: String verifying IsNonBlank("Veuillez renseigner le prénom")
  lastName: String verifying IsNonBlank("Veuillez renseigner le nom")
  email: Email
  city: Option[String]
  comment: Option[String]
  seats: List[String]
  prices: List[ReservationPrice]

  verify {
    "Veuillez répartir l'ensemble des sièges dans les tarifs et vérifier à ne pas dépasser."
    (reservation) => {
      reservation.seats.size == reservation.prices.foldLeft[Number](0, (acc: Number, price: ReservationPrice) => {acc + price.count})
    }
  }
}

type ReservedSeats = List[String] verifying ListIsNonEmpty verifying ListHasUniqueElements

type ReservationPrice {
  price: String verifying IsNonBlank("Veuillez sélectionner le prix")
  count: Number
}