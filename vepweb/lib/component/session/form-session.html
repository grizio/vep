<form-steps current="current" data="session" on-loaded="initialize" on-submit="postSession" on-valid="onValid">
    <form-step name="general" label="'Information générale'" when="true">
        <div class="panel success" ng-if="done">
            La séance a bien été enregistrée.
            Nous vous proposons ci-dessous d'en enregistrer une nouvelle à partir des informations de la précédente.
        </div>

        <input-one-choice name="theater" label="Théâtre" required="true"
                          with-id="form-session-theater" choices="theaterChoices" parent="general"></input-one-choice>
        <input-date type="datetime" name="date" label="Date" required="true" with-id="form-session-date"
                    parent="general" step="15" min="minDate"></input-date>
        <input-date type="datetime" name="reservationEndDate" label="Fin de réservation" required="true"
                    with-id="form-session-reservationEndDate" parent="general" step="15" min="minReservationEndDate"
                    max="maxReservationEndDate"></input-date>
    </form-step>
    <form-step name="shows" label="'Pièces'" when="true">
        <field-select-multiple-shows name="internalShows" min="1" parent="shows"></field-select-multiple-shows>
    </form-step>
    <form-step name="prices" label="'Prix'" when="true">
        <field-price name="prices" min="1" parent="prices"></field-price>
    </form-step>
    <form-step name="summary" label="'Résumé'" when="true" coming-from-previous-step="initSummary">
        <div class="row">
            <div class="small-6 columns">
                <h3>Informations générales</h3>

                <input-text name="name" label="Nom de la séance" required="true" with-id="form-session-name"
                            parent="summary"></input-text>

                <ul>
                    <li>Date de la séance : {{ session.strDate }}</li>
                    <li>Date de fin de réservation : {{ session.strReservationEndDate }}</li>
                </ul>
            </div>
            <div class="small-6 columns">
                <h3>Théâtre</h3>

                <theater-card canonical="selectedTheater" small="true" ng-if="current == 'summary'"></theater-card>
            </div>
        </div>
        <div class="row">
            <div class="small-6 columns">
                <h3>Prix</h3>

                <price-card price="price" ng-repeat="price in session.prices"></price-card>
            </div>
            <div class="small-6 columns">
                <h3>Pièces</h3>

                <div ng-repeat="show in session.internalShows">
                    <show-card canonical="show.show" ng-if="current == 'summary'" small="true"></show-card>
                </div>
            </div>
        </div>
        </div>
    </form-step>
</form-steps>