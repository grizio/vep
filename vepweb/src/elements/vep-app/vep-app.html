<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/kwc-app/kwc-app.html">
<link rel="import" href="/bower_components/kwc-i18n/kwc-i18n.html">
<link rel="import" href="/bower_components/app-router/app-router.html">
<link rel="import" href="/dist/elements/on-granted/on-granted.html">
<link rel="import" href="/dist/lib/vep/services/page-service/page-service.html">
<link rel="import" href="/dist/lib/vep/services/login-service/login-service.html">

<dom-module id="vep-app">
  <template>
    <style>
      kwc-app {
        --kwc-top-bar-bg-color: #212121;
        --kwc-top-bar-color: #fafafa;
        --kwc-top-bar-link-menu-styles: {
          font-weight: normal;
        };
        --kwc-top-bar-link-menu-hover-styles: {
          background-color: #616161;
        };
      }

      ::content kwc-table ::content table {
        width: 100%;
        border: 1px solid #212121;
        border-collapse: collapse;
        margin: 1rem 0;
      }

      ::content kwc-table ::content thead {
        background-color: #212121;
        color: #fafafa;
      }

      ::content kwc-table ::content thead th {
        padding: 0.25rem;
      }

      ::content kwc-table ::content tbody td {
        padding: 0.25rem;
        border-left: 1px solid #bdbdbd;
        border-right: 1px solid #bdbdbd;
      }

      ::content kwc-table ::content tbody td a {
        display: block;
      }

      ::content kwc-table ::content tbody tr:nth-of-type(even) {
        background-color: #e0e0e0;
      }

      ::content kwc-table ::content tbody tr:nth-of-type(odd) {
        background-color: #f5f5f5;
      }

      ::content kwc-table ::content .sortable {
        cursor: pointer;
      }

      ::content kwc-table ::content .sorted.level1 {
        text-decoration: underline;
      }

      ::content kwc-table ::content .sorted.up {
        background: url("/public/images/sorted-up.png") no-repeat right center;
      }

      ::content kwc-table ::content .sorted.down {
        background: url("/public/images/sorted-down.png") no-repeat right center;
      }

      ::content kwc-callout ::content {
        padding: 0.5rem;
      }
    </style>

    <kwc-i18n key="vep-app.topbar.sitename" var="{{i18nSitename}}"></kwc-i18n>
    <kwc-app logo="/public/images/logo-acve.png" sitename="[[i18nSitename]]" sitehome="/">
      <div class="top-bar-left-menu">
        <ul>
          <li>
            <a href="/">
              <kwc-i18n key="vep-app.topbar.home" show></kwc-i18n>
            </a>
          </li>
          <li>
            <a href="/shows">
              <kwc-i18n key="vep-app.topbar.shows" show></kwc-i18n>
            </a>
          </li>
          <li>
            <a href="/sessions">
              <kwc-i18n key="vep-app.topbar.sessions" show></kwc-i18n>
            </a>
          </li>
          <template is="dom-repeat" items="[[_pages]]" as="page">
            <li>
              <a href="/page/[[page.canonical]]">
                [[page.title]]
              </a>
            </li>
          </template>
          <li>
            <a href="/contact">
              <kwc-i18n key="vep-app.topbar.contact" show></kwc-i18n>
            </a>
          </li>
        </ul>
      </div>

      <div class="top-bar-right-menu">
        <ul hidden$="[[_logged]]">
          <li>
            <a href="/login">
              <kwc-i18n key="vep-app.topbar.login" show></kwc-i18n>
            </a>
          </li>
        </ul>
        <ul hidden$="[[!_logged]]">
          <on-granted roles="user-manager" hide>
            <li>
              <a href="/user/role/management">
                <kwc-i18n key="vep-app.topbar.roles" show></kwc-i18n>
              </a>
            </li>
          </on-granted>
          <on-granted roles="page-manager" hide>
            <li>
              <a href="/cms/pages">
                <kwc-i18n key="vep-app.topbar.pages" show></kwc-i18n>
              </a>
            </li>
          </on-granted>
          <on-granted roles="theater-manager" hide>
            <li>
              <a href="/theaters">
                <kwc-i18n key="vep-app.topbar.theaters" show></kwc-i18n>
              </a>
            </li>
          </on-granted>
          <on-granted roles="company-manager" hide>
            <li>
              <a href="/companies">
                <kwc-i18n key="vep-app.topbar.companies" show></kwc-i18n>
              </a>
            </li>
          </on-granted>
          <li>
            <a href="/" id="logout">
              <kwc-i18n key="vep-app.topbar.logout" show></kwc-i18n>
            </a>
          </li>
        </ul>
      </div>

      <div class="content">
        <kwc-callout type="warning" closeable show="{{_showUseCookies}}">
          <p><kwc-i18n key="global.use-cookies" show></kwc-i18n></p>
        </kwc-callout>

        <app-router mode="pushstate" trailingSlash="ignore">
          <app-route path="/" import="/dist/pages/cms/page-home/page-home.html"></app-route>
          <app-route path="/shows" import="/dist/pages/shows/page-shows/page-shows.html"></app-route>
          <app-route path="/show/read/:canonical" import="/dist/pages/shows/page-show/page-show.html"></app-route>
          <app-route path="/show/create" import="/dist/pages/shows/page-form-show/page-form-show.html"></app-route>
          <app-route path="/show/update/:canonical" import="/dist/pages/shows/page-form-show/page-form-show.html"></app-route>
          <app-route path="/page/:canonical" import="/dist/pages/cms/page-read-page/page-read-page.html"></app-route>
          <app-route path="/contact" import="/dist/pages/cms/page-contact/page-contact.html"></app-route>
          <app-route path="/login" import="/dist/pages/user/page-login/page-login.html"></app-route>
          <app-route path="/cms/pages" import="/dist/pages/cms/page-list-pages/page-list-pages.html"></app-route>
          <app-route path="/cms/pages/create"
                     import="/dist/pages/cms/page-create-page/page-create-page.html"></app-route>
          <app-route path="/cms/page/update/:canonical"
                     import="/dist/pages/cms/page-update-page/page-update-page.html"></app-route>
          <app-route path="/sessions" import="/dist/pages/session/page-sessions/page-sessions.html"></app-route>
          <app-route path="/session/read/:theaterCanonical/:sessionCanonical"
                     import="/dist/pages/session/page-read-session/page-read-session.html"></app-route>
          <app-route path="/session/create" import="/dist/pages/session/page-form-session/page-form-session.html"></app-route>
          <app-route path="/reservation/:theaterCanonical/:sessionCanonical"
                     import="/dist/pages/session/page-reservation/page-reservation.html"></app-route>
          <app-route path="/user/role/management"
                     import="/dist/pages/user/page-roles/page-roles.html"></app-route>
          <app-route path="/user/role/management"
                     import="/dist/pages/user/page-roles/page-roles.html"></app-route>
          <app-route path="/theaters" import="/dist/pages/theater/page-theaters/page-theaters.html"></app-route>
          <app-route path="/theater/create" import="/dist/pages/theater/page-form-theater/page-form-theater.html"></app-route>
          <app-route path="/theater/update/:canonical" import="/dist/pages/theater/page-form-theater/page-form-theater.html"></app-route>
          <app-route path="/companies" import="/dist/pages/company/page-companies/page-companies.html"></app-route>
          <app-route path="/company/create" import="/dist/pages/company/page-form-company/page-form-company.html"></app-route>
          <app-route path="/company/update/:canonical" import="/dist/pages/company/page-form-company/page-form-company.html"></app-route>
        </app-router>
      </div>
    </kwc-app>

    <login-service id="loginService" logged="{{_logged}}"></login-service>
  </template>

  <script src="./vep-app.js" inline></script>
</dom-module>